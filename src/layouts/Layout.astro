---
const { title = "GEM Restaurant", description = "" } = Astro.props;
import CookieBanner from "../components/CookieBanner.astro";
---
<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <!-- FONT -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- GLOBAL STYLE -->
    <style>
      :root {
        --gold: #d3bc22ff;
        --gold-light: #e8c547;
        --gold-dark: #b8941f;
        --bg-primary: #0a0e17;
        --bg-secondary: #12161f;
        --bg-tertiary: #1a1f2e;
        --text-primary: #f8fafc;
        --text-secondary: #cbd5e1;
        --text-muted: #64748b;
        --border: rgba(255, 255, 255, 0.08);
        --border-hover: rgba(255, 255, 255, 0.15);
      }

      * { 
        margin: 0; 
        padding: 0; 
        box-sizing: border-box; 
      }

      html {
        scroll-behavior: smooth;
      }

      body {
        background: var(--bg-primary);
        color: var(--text-secondary);
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        font-weight: 400;
        line-height: 1.7;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      /* Background Pattern */
      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
          radial-gradient(circle at 20% 20%, rgba(212, 175, 55, 0.03) 0%, transparent 50%),
          radial-gradient(circle at 80% 80%, rgba(212, 175, 55, 0.02) 0%, transparent 50%);
        pointer-events: none;
        z-index: 0;
      }

      a { 
        text-decoration: none; 
        color: inherit; 
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 2rem;
        position: relative;
        z-index: 1;
      }

      /* HEADER */
      header {
        position: fixed;
        top: 0; 
        left: 0; 
        right: 0;
        background: rgba(10, 14, 23, 0.85);
        backdrop-filter: blur(20px) saturate(180%);
        border-bottom: 1px solid var(--border);
        z-index: 100;
        transition: all 0.3s ease;
      }

      header.scrolled {
        background: rgba(10, 14, 23, 0.95);
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.4);
      }

      .header-inner {
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 14px;
        position: relative;
        z-index: 2;
      }

      .logo-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: 'Playfair Display', serif;
        font-weight: 700;
        font-size: 1.4rem;
        color: var(--bg-primary);
        box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
      }

      .logo-text {
        font-family: 'Playfair Display', serif;
        letter-spacing: 0.15em;
        text-transform: uppercase;
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text-primary);
        position: relative;
      }

      .logo-text::after {
        content: '';
        position: absolute;
        bottom: -3px;
        left: 0;
        width: 0;
        height: 2px;
        background: var(--gold);
        transition: width 0.3s ease;
      }

      .logo:hover .logo-text::after {
        width: 100%;
      }

      /* Navigation */
      nav {
        display: flex;
        gap: 0.5rem;
        align-items: center;
      }

      nav a {
        padding: 0.65rem 1.2rem;
        font-size: 0.95rem;
        font-weight: 500;
        color: var(--text-secondary);
        border-radius: 8px;
        position: relative;
        letter-spacing: 0.02em;
      }

      nav a:not(.btn-primary):hover {
        color: var(--text-primary);
        background: rgba(255, 255, 255, 0.04);
      }

      nav a:not(.btn-primary)::before {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 0;
        height: 2px;
        background: var(--gold);
        transition: width 0.3s ease;
      }

      nav a:not(.btn-primary):hover::before {
        width: 60%;
      }

      .btn-primary {
        padding: 0.65rem 1.6rem;
        border-radius: 9999px;
        color: var(--bg-primary);
        background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
        font-weight: 600;
        letter-spacing: 0.05em;
        border: none;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(212, 175, 55, 0.25);
        position: relative;
        overflow: hidden;
      }

      .btn-primary::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
        transition: left 0.5s ease;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
      }

      .btn-primary:hover::before {
        left: 100%;
      }

      .btn-primary:active {
        transform: translateY(0);
      }

      /* HAMBURGER BUTTON (M·∫∂C ƒê·ªäNH ·∫®N, CH·ªà MOBILE M·ªöI HI·ªÜN) */
      .menu-toggle {
        display: none;
        width: 40px;
        height: 40px;
        border-radius: 999px;
        border: 1px solid var(--border);
        background: rgba(15, 23, 42, 0.9);
        align-items: center;
        justify-content: center;
        flex-direction: column;
        gap: 5px;
        cursor: pointer;
        z-index: 110;
      }

      .menu-toggle span {
        display: block;
        width: 18px;
        height: 2px;
        border-radius: 999px;
        background: var(--text-primary);
        transition: transform 0.25s ease, opacity 0.25s ease, width 0.25s ease;
      }

      .menu-toggle.open span:nth-child(1) {
        transform: translateY(5px) rotate(45deg);
      }

      .menu-toggle.open span:nth-child(2) {
        opacity: 0;
        width: 0;
      }

      .menu-toggle.open span:nth-child(3) {
        transform: translateY(-5px) rotate(-45deg);
      }

      /* CART BUTTON */
      .cart-button {
        position: fixed;
        top: 90px;
        right: 1.5rem;
        width: 48px;
        height: 48px;
        border-radius: 999px;
        background: linear-gradient(135deg, var(--gold), var(--gold-light));
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.6);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--bg-primary);
        font-size: 1.4rem;
        z-index: 120;
        text-decoration: none;
        border: 1px solid rgba(248, 250, 252, 0.2);
        cursor: pointer;
      }

      .cart-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 14px 30px rgba(0, 0, 0, 0.75);
      }

      .cart-count {
        position: absolute;
        top: -5px;
        right: -5px;
        min-width: 18px;
        height: 18px;
        border-radius: 999px;
        background: #dc2626;
        color: #f9fafb;
        font-size: 0.7rem;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0 4px;
        border: 1px solid rgba(15, 23, 42, 0.9);
      }

      /* MAIN CONTENT */
      main {
        padding-top: 100px;
        min-height: 70vh;
      }

      /* FOOTER */
      footer {
        margin-top: 6rem;
        padding: 4rem 0 2rem;
        text-align: center;
        color: var(--text-muted);
        border-top: 1px solid var(--border);
        background: var(--bg-secondary);
        position: relative;
      }

      .footer-content {
        display: flex;
        flex-direction: column;
        gap: 2rem;
        align-items: center;
      }

      .footer-logo {
        font-family: 'Playfair Display', serif;
        font-size: 1.5rem;
        color: var(--gold);
        letter-spacing: 0.12em;
        margin-bottom: 0.5rem;
      }

      .footer-links {
        display: flex;
        gap: 2rem;
        flex-wrap: wrap;
        justify-content: center;
      }

      .footer-links a {
        color: var(--text-muted);
        font-size: 0.9rem;
        transition: color 0.3s ease;
      }

      .footer-links a:hover {
        color: var(--gold);
      }

      .footer-divider {
        width: 60px;
        height: 1px;
        background: var(--gold);
        margin: 1rem auto;
      }

      .footer-copyright {
        font-size: 0.85rem;
        color: var(--text-muted);
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .container {
          padding: 0 1.5rem;
        }

        .header-inner {
          height: 70px;
          gap: 0.75rem;
        }

        .logo-text {
          font-size: 1.1rem;
        }

        .logo-icon {
          width: 36px;
          height: 36px;
          font-size: 1.2rem;
        }

        /* HI·ªÜN N√öT HAMBURGER, ·∫®N NAV M·∫∂C ƒê·ªäNH */
        .menu-toggle {
          display: flex;
        }

        nav {
          position: fixed;
          top: 70px;
          left: 0;
          right: 0;
          flex-direction: column;
          background: rgba(10, 14, 23, 0.98);
          backdrop-filter: blur(20px);
          padding: 2rem 1.5rem 1.5rem;
          gap: 0.5rem;
          transform: translateY(-100%);
          opacity: 0;
          visibility: hidden;
          transition: all 0.3s ease;
          border-bottom: 1px solid var(--border);
          z-index: 105;
        }

        nav.open {
          transform: translateY(0);
          opacity: 1;
          visibility: visible;
        }

        nav a {
          width: 100%;
          text-align: center;
          padding: 1rem;
        }

        main {
          padding-top: 90px;
        }

        .footer-links {
          flex-direction: column;
          gap: 1rem;
        }

        .cart-button {
          top: 80px;
          right: 1rem;
          width: 42px;
          height: 42px;
          font-size: 1.2rem;
        }
      }

      /* Scroll Behavior */
      @media (prefers-reduced-motion: reduce) {
        html {
          scroll-behavior: auto;
        }
        
        * {
          animation-duration: 0.01ms !important;
          transition-duration: 0.01ms !important;
        }
      }
    </style>

    <script>
      // Header scroll effect
      window.addEventListener('scroll', () => {
        const header = document.querySelector('header');
        if (window.scrollY > 20) {
          header && header.classList.add('scrolled');
        } else {
          header && header.classList.remove('scrolled');
        }
      });

      // Mobile menu toggle (hamburger)
      document.addEventListener('DOMContentLoaded', () => {
        const toggle = document.querySelector('.menu-toggle');
        const nav = document.querySelector('header nav');
        
        if (toggle && nav) {
          toggle.addEventListener('click', () => {
            nav.classList.toggle('open');
            toggle.classList.toggle('open');
            const expanded = toggle.classList.contains('open');
            toggle.setAttribute('aria-expanded', expanded ? 'true' : 'false');
          });
        }

        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
          const target = e.target;
          if (!(target instanceof HTMLElement)) return;
          if (!target.closest('nav') && !target.closest('.menu-toggle')) {
            nav && nav.classList.remove('open');
            toggle && toggle.classList.remove('open');
            toggle && toggle.setAttribute('aria-expanded', 'false');
          }
        });
      });

      // N√öT GI·ªé H√ÄNG V√ÄNG HO·∫†T ƒê·ªòNG + HI·ªÜN S·ªê L∆Ø·ª¢NG
      function updateGlobalCart() {
        let cart = [];
        try {
          const saved = localStorage.getItem("cart");
          if (saved) cart = JSON.parse(saved);
        } catch (e) { cart = []; }

        const total = cart.reduce((sum, item) => sum + (item.qty || 1), 0);
        const countEl = document.getElementById("global-cart-count");
        if (countEl) {
          countEl.textContent = total;
          countEl.style.display = total > 0 ? "flex" : "none";
        }
      }

      // B·∫•m n√∫t v√†ng ‚Üí v√†o Checkout
      document.addEventListener('DOMContentLoaded', () => {
        const cartBtn = document.getElementById("global-cart-button");
        cartBtn && cartBtn.addEventListener("click", () => {
          window.location.href = "/checkout";
        });
      });

      // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng khi c√≥ thay ƒë·ªïi (t·ª´ menu ho·∫∑c checkout)
      window.addEventListener("storage", (e) => {
        if (e.key === "cart") updateGlobalCart();
      });
      window.addEventListener("cartUpdated", updateGlobalCart);

      // C·∫≠p nh·∫≠t ngay khi load trang
      updateGlobalCart();
    </script>
  </head>
  <body>
    <!-- HEADER -->
    <header>
      <div class="container header-inner">
        <a href="/" class="logo">
          <div class="logo-icon">G</div>
          <span class="logo-text">GEM Restaurant</span>
        </a>
        <button class="menu-toggle" type="button" aria-label="Men√º √∂ffnen" aria-expanded="false">
          <span></span>
          <span></span>
          <span></span>
        </button>
        <nav>
          <a href="/">Home</a>
          <a href="/menu">Menu</a>
          <a href="/speisekarte">Online bestellen</a>
          <a href="/reservierung">Reservierung</a>
          <a href="/angebot">Angebot</a>
          <a href="/kontakt">Kontakt</a>
          <a href="/mitnahme">Mitnahme</a>
          <a class="btn-primary" href="/reservierung">Reservieren</a>
        </nav>
      </div>
    </header>

    <!-- CART BUTTON -->
    <button type="button" id="global-cart-button" class="cart-button" aria-label="Warenkorb">
      üõí
      <span id="global-cart-count" class="cart-count">0</span>
    </button>

    <!-- MAIN -->
    <main>
      <div class="container">
        <slot />
      </div>
    </main>

    <!-- FOOTER -->
    <footer>
      <div class="container">
        <div class="footer-content">
          <div>
            <div class="footer-logo">GEM</div>
            <div class="footer-divider"></div>
          </div>
          <nav class="footer-links">
            <a href="/">Home</a>
            <a href="/speisekarte">Online bestellen</a>
            <a href="/angebot">Angebot</a>
            <a href="/kontakt">Kontakt</a>
            <a href="/mitnahme">Mitnahme</a>
            <a href="/impressum">Impressum</a>
            <a href="/datenschutz">Datenschutz</a>
          </nav>
          <p class="footer-copyright">
            ¬© {new Date().getFullYear()} GEM Restaurant ¬∑ Alle Rechte vorbehalten
          </p>
        </div>
      </div>
    </footer>

    <CookieBanner />
  </body>
</html>
